---
globs: *.py
description: Python coding standards for SuperWhisper
---

# Python Coding Standards –¥–ª—è SuperWhisper

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### –Ø–∑—ã–∫ –∏ —Å—Ç–∏–ª—å
- **Python 3.11+** - —Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Python
- **–†—É—Å—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —á–µ—Ä–µ–∑ `logging.getLogger(__name__)`
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π** —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

### –ò–º–ø–æ—Ä—Ç—ã
```python
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import logging
import sys
from pathlib import Path

# –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import torch
import numpy as np
import pyaudio

# –õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
from src.config import Config
from src.whisper_service import WhisperService
```

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### –°–µ—Ä–≤–∏—Å—ã
–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Å–ª–µ–¥—É—é—Ç –µ–¥–∏–Ω–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É:

```python
class MyService:
    def __init__(self, config):
        self.config = config
        self.logger = logging.getLogger(__name__)

    def process(self, data):
        try:
            self.logger.info(f"–ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏: {data}")
            # –æ–±—Ä–∞–±–æ—Ç–∫–∞
            self.logger.info("–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
            return result
        except Exception as e:
            self.logger.error(f"–û—à–∏–±–∫–∞: {e}")
            raise
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
```python
def _cleanup_memory(self):
    """–û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"""
    try:
        gc.collect()
        self.logger.debug("–ü–∞–º—è—Ç—å –æ—á–∏—â–µ–Ω–∞")
    except Exception as e:
        self.logger.error(f"–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ø–∞–º—è—Ç–∏: {e}")
```

### –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```python
def __init__(self, config):
    self.model = None  # –ù–µ –∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ä–∞–∑—É

def _load_model(self):
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏"""
    if self.model is None:
        self.logger.info("–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏...")
        # –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
```

## üìù –°–æ–≥–ª–∞—à–µ–Ω–∏—è –ø–æ –∫–æ–¥—É

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
# –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º __name__
self.logger = logging.getLogger(__name__)

# –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
self.logger.debug("–î–µ—Ç–∞–ª–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏")
self.logger.info("–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è")
self.logger.warning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è")
self.logger.error("–û—à–∏–±–∫–∏")
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```python
try:
    # —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
    result = risky_operation()
except SpecificException as e:
    self.logger.error(f"–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
    # graceful degradation
except Exception as e:
    self.logger.error(f"–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
    raise
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```python
# –î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–≥—É
audio_config = self.config.audio
sample_rate = audio_config["sample_rate"]

# –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø —Å –¥–µ—Ñ–æ–ª—Ç–æ–º
enabled = self.config.ui.get("auto_paste_enabled", True)
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥
- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤ `test_basic.py`
- –ê–≤—Ç–æ–≤—Å—Ç–∞–≤–∫–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `test_auto_paste_debug.py`
- –õ–æ–≥–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
# –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã
./venv/bin/python test_basic.py

# –¢–µ—Å—Ç –∞–≤—Ç–æ–≤—Å—Ç–∞–≤–∫–∏ —Å –ª–æ–≥–∞–º–∏
./venv/bin/python test_auto_paste_debug.py
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏
–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–∏—à—É—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è troubleshooting:

```python
# –ê–≤—Ç–æ–≤—Å—Ç–∞–≤–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π —à–∞–≥
üîÑ –ê–≤—Ç–æ–≤—Å—Ç–∞–≤–∫–∞ –≤—ã–∑–≤–∞–Ω–∞ —Å —Ç–µ–∫—Å—Ç–æ–º: '–ü—Ä–∏–≤–µ—Ç –º–∏—Ä!'
üìä –î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞: 11 —Å–∏–º–≤–æ–ª–æ–≤
üìã –ù–∞—á–∏–Ω–∞–µ–º –≤—Å—Ç–∞–≤–∫—É —á–µ—Ä–µ–∑ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
üíæ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –±—É—Ñ–µ—Ä: '...'
üìù –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç: '–ü—Ä–∏–≤–µ—Ç –º–∏—Ä!'
‚å®Ô∏è –û—Ç–ø—Ä–∞–≤–ª—è–µ–º Cmd+V
‚úÖ –ê–≤—Ç–æ–≤—Å—Ç–∞–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
```

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- **DEBUG** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- **INFO** - –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- **WARNING** - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- **ERROR** - –æ—à–∏–±–∫–∏ —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è

## üì¶ –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ

### –ß–∏—Å—Ç—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤
- –¢–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ README.md

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å—ë
./install_and_run.sh

# –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—É—Å–∫–∏ –∏–∑ –ª—é–±–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
superwhisper
```